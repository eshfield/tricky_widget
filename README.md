# Tricky Widget

## Задача
Создать виджет, который занимает всю доступную ширину экрана и принимает в параметрах конструктора текст произвольной длины вместе с boolean-значением состояния чекбокса.

Внешний вид виджета:
```
Текст | -------------------- | Чекбокс
```
Разделители `|` показаны условно — визуальных границ между ячейками нет

Виджет состоит из трёх ячеек:
1. Переданный текст
2. Пунктирная линия от начала до конца ячейки
3. Чекбокс с переданным состоянием

Средняя ячейка занимает всё доступное ей между остальными ячейками место. Сужение элемента сначала приводит к сокращению пунктирной линии до минимального размера 10 px, после чего линия перестаёт быть видимой, и в первой ячейке начинает обрезаться текст с добавлением многоточия. При возвращении виджету пространства конфигурация ячеек восстанавливается в исходное состояние.

## Проблема
Сложность задачи заключается в том, что для описанного поведения первой и второй ячеек требуется обернуть их в `Expanded`:
* тексту это нужно для возможности использовать параметр `overflow` для сокращения с добавлением многоточия 
* пунктирной линии это необходимо для выполнения условия занимать всё свободное пространство между первой и третьей ячейками

Однако подход просто одновременно обернуть эти элементы в `Expanded` сломает требуемое поведение каждого из них — ячейки начнут делить доступное им пространство не так как надо, и никакой настройкой параметров `flex` исправить это будет невозможно.

## Решение
Решение заключается в попеременном оборачивании первой и второй ячеек в `Expanded` в зависимости от состояния виджета — требуется ли скрывать пунктирную линию и начинать сокращать текст или нет — то есть переходит ли виджет в компактный режим или выходит из него.

Для включения и выключения компактного режима проверяются следующие условия:
* явно указанное в задаче достижение средней ячейкой указанного минимального размера
* проверка возможности размещения полного текста без обрезки в доступном первой ячейке пространстве; выполняется вручную при помощи невидимого на экране рендеринга полного текста в объекте `TextPainter` в рамках текущего размера первой ячейки и проверки вписывается ли этот «виртуальный» текст в имеющиеся размеры